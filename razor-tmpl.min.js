String.prototype.razorReplaceAll=function(n,t){return this.replace(new RegExp(n,"g"),t)};String.prototype.razorReplaceAll._doc="str.razorReplaceAll(old,new),use new RegExp(old,g)";String.prototype.razorFormat=function(){var n=this;for(var t in arguments)n=n.razorReplaceAll("\\{"+t+"\\}",arguments[t].toString());return n};String.prototype.razorFormat._doc="str.razorFormat(obj0, obj1, obj2) , no obj count limit",function(n){function r(n,t){this.Content=n;this.SegmentType=t;this.toString=function(){return this.Content}}function o(n){this.template=n;this.processedIndex=-1;this.segments=[]}var t={version:"1.0.0",update_date:"2014-8-17",debuging:!1},e;typeof module!="undefined"&&module.exports?module.exports=t:typeof window!="undefined"?window.razor=t:n.razor=t;r._doc="Segment constructor";o._doc="StringBlockModel constructor";var i={CodeBlock:0,Variable:1,String:2},s={Each:/^each\s*?\([\s\S]+?\)\s*?\{[\s\S]*?\}/,Noraml:/[\S\s]*?\{[\S\s]*?\}/},f={symbol:"@",process:function(n){var t=new o(n);return f.processStringBlock(t),t.segments},processStringBlock:function(n){for(var e,i,r,f,u=n.template,t=0,o=u.length;t<o;t++)if(e=u[t],i="",e==this.symbol)if(this.processString(n,t),i=u[t+1],i==this.symbol){t=this.processEscapeSymbol(n,t);continue}else if(i=="*"){t=this.processComment(n,t);continue}else{for(r=t+1;i==" "||i=="\n";)i=u[++r];switch(i){case"{":t=this.processCodeBlock(n,t,r);break;case"(":t=this.processVariable(n,t,r);break;default:f=n.template.substring(r);s.Each.test(f)?t=this.processEach(n,t,r):s.Noraml.test(f)&&(t=this.processNormal(n,t,r))}}this.processString(n,n.template.length)},processString:function(n,t){var u=n.template.substring(n.processedIndex+1,t);u.trim()&&n.segments.push(new r(u,i.String));n.processedIndex=t-1},processComment:function(n,t){var u=n.template.substring(t),r=u.indexOf("*"+this.symbol),i;return r>-1?(i=r+t+1,n.processedIndex=i,i):t+1},processEscapeSymbol:function(n,t){return n.segments.push(new r(this.symbol,i.String)),n.processedIndex=t+1,n.processedIndex},processCodeBlock:function(n,t,u){var e=this.getSecondIndex(n.template,u),f=n.template.substring(u+1,e);return f&&(f=this.decodeHtmlEntity(f),n.segments.push(new r(f,i.CodeBlock))),n.processedIndex=e},processVariable:function(n,t,f){var o=this.getSecondIndex(n.template,f),e=n.template.substring(t+2,o).trim();return e&&(e=this.decodeHtmlEntity(e),/^-/g.test(e)?(e=e.substring(1).trim(),e+=".replace(/&/g,'&amp;')",e+=".replace(/<\/g,'&lt;')",e+=".replace(/>/g,'&gt;')",e+=".replace(/'/g,'&#39;')",e+='.replace(/"/g,"&#34;")',e+=".replace(/\\//g,'&#47;')",n.segments.push(new r(e,i.Variable))):/^=/g.test(e)?(e=e.substring(1).trim(),e=u.modelName+"."+e,n.segments.push(new r(e,i.Variable))):n.segments.push(new r(e,i.Variable))),n.processedIndex=o},processEach:function(n,t){var f=n.template.substring(t),e=f.indexOf("(")+t,a=this.getSecondIndex(n.template,e),o=f.indexOf("{")+t,s=this.getSecondIndex(n.template,o),u=n.template.substring(e+1,a),h=u.indexOf("in"),v=u.substring(0,h).trim(),y=u.substring(h+2).trim(),p="for(var $index = 0,$length = {1}.length;$index < $length;$index++) { var {0} = {1}[$index];".razorFormat(v,y),c,l;return n.segments.push(new r(p,i.CodeBlock)),c=n.template.substring(o+1,s),l=this.process(c),n.segments=n.segments.concat(l),n.segments.push(new r("}",i.CodeBlock)),n.processedIndex=s},processNormal:function(n,t,u){var h=n.template.substring(t),f=h.indexOf("{")+t,o=this.getSecondIndex(n.template,f),e=n.template.substring(u,f+1),c=n.template.substring(f+1,o),s;return e=this.decodeHtmlEntity(e),n.segments.push(new r(e,i.CodeBlock)),s=this.process(c),n.segments=n.segments.concat(s),n.segments.push(new r("}",i.CodeBlock)),n.processedIndex=o},getSecondIndex:function(n,t){for(var u,f=n.substr(t,1),e={"{":"}","(":")"}[f],r=1,i=t+1,o=n.length;i<o;i++)if(u=n.substr(i,1),u==e){if(r--,r==0)break}else u==f&&r++;return i},decodeHtmlEntity:function(n){return n.razorReplaceAll("&lt;","<").razorReplaceAll("&gt;",">").razorReplaceAll("&amp;","&")}},u={modelName:"ViewBag",escapeInFunction:function(n){return n?n.replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/(\r?\n)/g,"\\n"):n},compileToCode:function(n){var r=["var $result='';"],o,f,e;try{for(o in n){f=n[o].Content;switch(n[o].SegmentType){case i.CodeBlock:r.push(f);break;case i.Variable:e="$result+={0};".razorFormat(f);r.push(e);break;case i.String:e="$result+='{0}';".razorFormat(u.escapeInFunction(f));r.push(e)}}return r.push("return $result;"),r.join("\n")}catch(s){if(console.log("template contains undefined variable,please check template & data !"),t.debuging){console.log("----- compiled code start -----");console.log(r.join("\n"));console.log("----- compiled code  end  -----");console.log();console.log("----- error start -----");throw s;}else return"return '';"}},compile:function(n){var i=u.compileToCode(n);try{return new Function(u.modelName,i)}catch(r){if(console.log("error when call 'new Function',please check template & data !"),t.debuging){console.log("----- compiled code start -----");console.log(i.join("\n"));console.log("----- compiled code  end  -----");console.log();console.log("----- error start -----");throw r;}else return function(){return""}}}};if(t.compile=function(n){var t=f.process(n);return u.compile(t)},t.compile._doc="function func = razor.compile(template)",t.render=function(n,t){var i,r,u;if(!this.withViewBag){i="";for(r in t)i+="var {0} = ViewBag['{0}'];".razorFormat(r);n="@{"+i+"}"+n}return u=this.compile(n),u(t)},t.render._doc="String result = razor.render(String template,Object ViewBag)",t.withViewBag=!0,t.symbol=function(n){return n?(f.symbol=n,this):f.symbol},t.symbol._doc="\n        get or set the char as the symbol\n        get : razor.symbol() default = '@'\n        set : razor.symbol(newSymbol)\n    ",t.model=function(n){return n?(u.modelName=n,this):u.modelName},t.model._doc="\n        get or set the data object used in the view\n        get : razor.model() default = 'ViewBag'\n        set : razor.model(newModelName)\n    ",t.init=function(){return this.withViewBag=!0,this.symbol("@").model("ViewBag")},t.init._doc="\n        you can custom by\n            razor.symbol        default = '@'\n            razor.model         default = ViewBag\n            razor.withViewBag   default = false,that means you need @(ViewBag.somevar)\n        \n        and this method is to change back to the default value.\n    ",t.encodeHtml=function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/\//g,"&#47;")},t.encodeHtml._doc="encode html entity",t.decodeHtml=function(n){return f.decodeHtmlEntity(n)},t.decodeHtml._doc="decode html entity",t._advance={toSegments:f.process,toCode:u.compileToCode},t._advance.toSegments._doc="Segment[] segments = toSegments(template)",t._advance.toCode._doc="String code = toCode(Segment[] segments)",typeof jQuery!="undefined"&&jQuery){e=jQuery;e(function(){e("[razor-template]").hide()});function c(n){var t=n.attr("razor-for")||n.attr("data-razor-for");return t?"for({0}){".razorFormat(t.trim()):(t=n.attr("razor-if")||n.attr("data-razor-if"),t)?"if({0}){".razorFormat(t.trim()):(t=n.attr("razor-while")||n.attr("data-razor-while"),t)?"while({0}){".razorFormat(t.trim()):(t=n.attr("razor-each")||n.attr("data-razor-each"),t)?"each({0}){".razorFormat(t):""}function h(n){var t=n[0].tagName==="SCRIPT"?n.html():n.attr("razor-template")||n.html(),i=c(n);return i&&(t=f.symbol+i+t+"}"),t}e.fn.extend({compile:function(){return t.compile(h(this))},render:function(n){var u=h(this),i=t.render(u,n),r;return this[0].tagName!=="SCRIPT"&&(this.attr("razor-template")||(r=this.html().trim(),this.attr("razor-template",r)),this.html(i),this.show()),i},renderToParent:function(n){var t=this.render(n);return this.parent().append(t),t}});e.fn.compile._doc="var func = $(selector).compile()";e.fn.render._doc="result = $(selector).render(ViewBag) , for div[data-razor-tmpl] or SCRIPT[type='template']";e.fn.renderToParent._doc="$(selector).renderToParent() , it use the jqObj.parent() to find parent,and append result"}}(this);
/*
//# sourceMappingURL=razor-tmpl.min.js.map
*/